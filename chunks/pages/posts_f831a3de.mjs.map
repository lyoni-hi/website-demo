{"version":3,"file":"posts_f831a3de.mjs","sources":["../../../src/pages/[lang]/blog/posts.json.ts"],"sourcesContent":["import type { APIContext, APIRoute } from \"astro\";\nimport type { BlogPost } from \"scripts-ssr/types\";\n\nasync function buildPostData(ctx: APIContext, req: () => Promise<BlogPost>) {\n    const post = await req();\n    const { description, publishDate, section, tags, title, updateDate } = post.frontmatter;\n    return {\n        url: new URL(post.url, ctx.url.origin).href,\n        title,\n        description,\n        section,\n        tags: tags.split(\",\").map(s => s.trim()) || [],\n        publishDate,\n        updateDate: updateDate ?? null,\n    };\n}\n\nexport const get: APIRoute = async (ctx: APIContext) => {\n    const files = Object.values(import.meta.glob<BlogPost>(\"./*.{md,mdx}\"));\n    const posts = await Promise.all(\n        Object.values(files).map(file => buildPostData(ctx, file))\n    );\n    posts.sort((a, b) => b.publishDate.getTime() - a.publishDate.getTime());\n\n    return { body: JSON.stringify(posts) };\n};\n"],"names":[],"mappings":"AAGA,eAAe,aAAA,CAAc,KAAiB,GAA8B,EAAA;AACxE,EAAM,MAAA,IAAA,GAAO,MAAM,GAAI,EAAA,CAAA;AACvB,EAAM,MAAA,EAAE,aAAa,WAAa,EAAA,OAAA,EAAS,MAAM,KAAO,EAAA,UAAA,KAAe,IAAK,CAAA,WAAA,CAAA;AAC5E,EAAO,OAAA;AAAA,IACH,GAAA,EAAK,IAAI,GAAI,CAAA,IAAA,CAAK,KAAK,GAAI,CAAA,GAAA,CAAI,MAAM,CAAE,CAAA,IAAA;AAAA,IACvC,KAAA;AAAA,IACA,WAAA;AAAA,IACA,OAAA;AAAA,IACA,IAAA,EAAM,IAAK,CAAA,KAAA,CAAM,GAAG,CAAA,CAAE,GAAI,CAAA,CAAA,CAAA,KAAK,CAAE,CAAA,IAAA,EAAM,CAAA,IAAK,EAAC;AAAA,IAC7C,WAAA;AAAA,IACA,YAAY,UAAc,IAAA,IAAA;AAAA,GAC9B,CAAA;AACJ,CAAA;AAEa,MAAA,GAAA,GAAgB,OAAO,GAAoB,KAAA;AACpD,EAAA,MAAM,QAAQ,MAAO,CAAA,MAAA,iBAAO,MAAA,CAAA,MAAA,CAAA,CAAA,YAAA,EAAA,MAAA,OAAA,qBAAA,CAAA,CAAA,CAA0C,CAAA,CAAA;AACtE,EAAM,MAAA,KAAA,GAAQ,MAAM,OAAQ,CAAA,GAAA;AAAA,IACxB,MAAA,CAAO,OAAO,KAAK,CAAA,CAAE,IAAI,CAAQ,IAAA,KAAA,aAAA,CAAc,GAAK,EAAA,IAAI,CAAC,CAAA;AAAA,GAC7D,CAAA;AACA,EAAM,KAAA,CAAA,IAAA,CAAK,CAAC,CAAA,EAAG,CAAM,KAAA,CAAA,CAAE,WAAY,CAAA,OAAA,EAAY,GAAA,CAAA,CAAE,WAAY,CAAA,OAAA,EAAS,CAAA,CAAA;AAEtE,EAAA,OAAO,EAAE,IAAA,EAAM,IAAK,CAAA,SAAA,CAAU,KAAK,CAAE,EAAA,CAAA;AACzC;;;;"}